<!DOCTYPE html>
<html>
<head>
    <title>{{title}}</title>
    <link href='css/bootstrap.css' rel="stylesheet">
    <link href='css/application.css' rel="stylesheet">
</head>
<body>
<header class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <span class="brand">Event MA</span>
        </div>
    </div>
</header>


{{{body}}}


<script type="text/javascript" src="/js/vendor/jquery.js"></script>
<script type="text/javascript" src="/js/vendor/json2.js"></script>
<script type="text/javascript" src="/js/vendor/underscore.js"></script>
<script type="text/javascript" src="/js/vendor/backbone.js"></script>
<script type="text/javascript" src="/js/vendor/backbone.marionette.js"></script>

<script type="text/template" id="static-template">

            <div class="event-poster__decoration" style="background-color: rgb(234, 100, 29);">
            </div>
            <div class="event-poster__header">

                <div class="event-poster__date">
                    <dd><%= dia%></dd>
                    <dd><%= hora%></dd>
                </div>
                <div class="event-poster__logo img-90 js-xd-background" style="background-color: rgb(234, 100, 29);">
                    <img class="js-poster-image js-d-retina"
                         src="https://img.evbuc.com/http%3A%2F%2Fcdn.evbuc.com%2Fimages%2F12807027%2F96524850111%2F1%2Foriginal.png?h=90&amp;w=90&amp;s=67a784ca9fc83bf75de147cb0b6452ee"
                         data-d-retina-src="https://img.evbuc.com/http%3A%2F%2Fcdn.evbuc.com%2Fimages%2F12807027%2F96524850111%2F1%2Foriginal.png?h=180&amp;w=180&amp;s=2dc4c035736b208bdc344243a245f33b"
                         alt="event logo" itemprop="image" dorsal-guid="89949f2f-660b-0685-4739-3249a4f63389"
                         data-xd-wired="retina">
                </div>
            </div>
            <div class="event-poster__description">
                <h4 id="item-name" class="event-poster__title">
                    <%= name%>
                </h4>

                <ul class="event-poster__info">
                    <li>
		                    <span class="text--truncated">
		                        <%= categoria%>
		                    </span>
                    </li>
                    <li>
		                    <span class="text--truncated">
		                        <%= lugar%>
                    </li>
                </ul>
            </div>

</script>

<script type="text/template" id="detalle-template">
    <div class="item-datos">
        <h1><%= name%></h1>
        <h2><%= categoria%></h2>
        <span><%= dia%></span>
        <span><%= hora%></span>
        <span><%= lugar%></span>
        <button class="btn btn-small">Atras</button>
    </div>
    <div class="item-img">
        <img class="js-poster-image js-d-retina"
             src="https://img.evbuc.com/http%3A%2F%2Fcdn.evbuc.com%2Fimages%2F12807027%2F96524850111%2F1%2Foriginal.png?h=90&amp;w=90&amp;s=67a784ca9fc83bf75de147cb0b6452ee"
             data-d-retina-src="https://img.evbuc.com/http%3A%2F%2Fcdn.evbuc.com%2Fimages%2F12807027%2F96524850111%2F1%2Foriginal.png?h=180&amp;w=180&amp;s=2dc4c035736b208bdc344243a245f33b"
             alt="event logo" itemprop="image" dorsal-guid="89949f2f-660b-0685-4739-3249a4f63389"
             data-xd-wired="retina">
    </div>
</script>

<script type="text/template" id="eventList-template">
    <div>
        <h1 class="item-title-event">Eventos</h1>
    </div>
    <section class="container-events"></section>
</script>

<script type="text/javascript">
    var EventManager = new Marionette.Application();
    EventManager.Evento = Backbone.Model.extend();

    EventManager.EventosCollection = Backbone.Collection.extend({
        model: EventManager.Evento
    });

    EventManager.addRegions({
        mainRegion: "#main-region"
    });

    EventManager.StaticView = Marionette.ItemView.extend({
        tagName: 'article',
        className: 'item-event',
        template: '#static-template'
    });

    EventManager.EventosView = Marionette.CollectionView.extend({
        tagName: "section",
        className: "container-events",
        childView: EventManager.StaticView,

        onBeforeRender: function () {
            console.log("Antes de mostrar las vistas")
        },
        onBeforeAddChild: function (childView) {
            console.log(childView);
        }

    });

    EventManager.on('start', function () {
        var eventModel1 = new EventManager.Evento({
            id: 1,
            dia: "Jue, Jun 19",
            hora: "06:00 AM",
            name: "Curso Marionette",
            categoria: "Desarrollo web",
            lugar: "Santiago, Chile"
        });

        var eventModel2 = new EventManager.Evento({
            id: 2,
            dia: "Jue, Jun 20",
            hora: "06:00 AM",
            name: "Curso Backbone",
            categoria: "Desarrollo web",
            lugar: "Santiago, Chile"
        });

        var eventModel3 = new EventManager.Evento({
            id: 3,
            dia: "Jue, Jun 21",
            hora: "06:00 AM",
            name: "Curso Java",
            categoria: "Desarrollo web",
            lugar: "Santiago, Chile"
        });

        var eventModel4 = new EventManager.Evento({
            id: 4,
            dia: "Jue, Jun 21",
            hora: "06:00 AM",
            name: "Curso JavaScript",
            categoria: "Desarrollo web",
            lugar: "Santiago, Chile"
        });
        
        var eventosColecion = new EventManager.EventosCollection([eventModel1, eventModel2, eventModel3]);

        var eventosListView = new EventManager.EventosView({
            collection: eventosColecion
        });

        $("#btn-add-item").on('click', function () {
            eventosColecion.add(eventModel4);
        });

        EventManager.mainRegion.show(eventosListView);
    })
    EventManager.start();
</script>
</body>
</html>
